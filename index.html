<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Vidiverse ¬∑ Dreht√ºrprojekt KGSE</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Outfit:wght@300;400;500&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0b0d14;--surface:#13161f;--surface2:#1c2030;--border:#ffffff12;--border2:#ffffff20;
  --accent:#6c63ff;--accent2:#ff6b6b;--accent3:#ffd93d;--accent4:#6bcb77;
  --text:#e8eaf0;--text2:#8b90a4;--text3:#5a5f74;--radius:12px;--glow:rgba(108,99,255,.25);
}
html{scroll-behavior:smooth}
body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
.page{display:none;position:relative;z-index:1;min-height:100vh}
.page.active{display:block}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:100;display:flex;align-items:center;justify-content:space-between;padding:.9rem 2rem;background:rgba(11,13,20,.88);backdrop-filter:blur(18px);border-bottom:1px solid var(--border)}
.nav-logo{font-family:'Syne',sans-serif;font-weight:800;font-size:1.3rem;background:linear-gradient(135deg,var(--accent),#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;cursor:pointer}
.nav-links{display:flex;gap:.3rem;align-items:center}
.nav-btn{background:none;border:none;color:var(--text2);font-family:'Outfit',sans-serif;font-size:.85rem;cursor:pointer;padding:.45rem .9rem;border-radius:8px;transition:background .15s,color .15s}
.nav-btn:hover{background:var(--surface2);color:var(--text)}
.nav-btn.active-tab{background:var(--surface2);color:var(--accent)}
.nav-btn.upload-btn{background:var(--accent);color:#fff;font-weight:500;margin-left:.4rem}
.nav-btn.upload-btn:hover{background:#5a52e8}

/* HERO */
.hero{padding:9rem 2rem 5rem;text-align:center;position:relative;overflow:hidden}
.hero-glow{position:absolute;top:-60px;left:50%;transform:translateX(-50%);width:700px;height:400px;background:radial-gradient(ellipse,rgba(108,99,255,.18) 0%,transparent 70%);pointer-events:none}
.hero-badge{display:inline-flex;align-items:center;gap:.5rem;font-size:.72rem;letter-spacing:.18em;text-transform:uppercase;color:var(--accent);background:rgba(108,99,255,.1);border:1px solid rgba(108,99,255,.3);border-radius:99px;padding:.35em 1em;margin-bottom:1.5rem;animation:fadeUp .6s ease both}
.hero h1{font-family:'Syne',sans-serif;font-size:clamp(2.8rem,7vw,5.5rem);font-weight:800;line-height:1.05;letter-spacing:-.03em;animation:fadeUp .6s .1s ease both}
.hero h1 .grad{background:linear-gradient(135deg,#fff 30%,var(--accent) 70%,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero-sub{margin-top:1.2rem;font-size:1.05rem;color:var(--text2);max-width:500px;margin-inline:auto;line-height:1.7;animation:fadeUp .6s .2s ease both}
.hero-actions{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-top:2.2rem;animation:fadeUp .6s .3s ease both}
.btn-primary{background:var(--accent);color:#fff;border:none;padding:.8rem 2rem;border-radius:10px;font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:500;cursor:pointer;transition:transform .15s,box-shadow .15s;box-shadow:0 4px 24px var(--glow)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 32px var(--glow)}
.btn-secondary{background:var(--surface2);color:var(--text);border:1px solid var(--border2);padding:.8rem 2rem;border-radius:10px;font-family:'Outfit',sans-serif;font-size:.95rem;cursor:pointer;transition:background .15s}
.btn-secondary:hover{background:#252a3a}

/* STATS */
.stats-bar{display:flex;justify-content:center;border-top:1px solid var(--border);border-bottom:1px solid var(--border);background:var(--surface);animation:fadeUp .6s .4s ease both}
.stat-item{flex:1;max-width:220px;padding:1.4rem 1rem;text-align:center;border-right:1px solid var(--border)}
.stat-item:last-child{border-right:none}
.stat-num{font-family:'Syne',sans-serif;font-size:1.8rem;font-weight:700;color:var(--accent)}
.stat-lbl{font-size:.75rem;color:var(--text3);text-transform:uppercase;letter-spacing:.12em;margin-top:.2rem}

/* SECTION */
section{padding:4rem 2rem;max-width:1200px;margin-inline:auto}
.section-header{display:flex;align-items:baseline;justify-content:space-between;margin-bottom:2.5rem;flex-wrap:wrap;gap:1rem}
.section-header h2{font-family:'Syne',sans-serif;font-size:1.7rem;font-weight:700}
.section-header h2 span{color:var(--accent)}

/* FILTER */
.filter-tabs{display:flex;gap:.5rem;margin-bottom:2rem;flex-wrap:wrap}
.filter-tab{background:var(--surface2);border:1px solid var(--border);color:var(--text2);padding:.4rem 1rem;border-radius:99px;font-size:.8rem;cursor:pointer;transition:all .15s;font-family:'Outfit',sans-serif}
.filter-tab:hover,.filter-tab.active{background:var(--accent);border-color:var(--accent);color:#fff}

/* GRID */
.project-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.2rem}
.project-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;cursor:pointer;transition:transform .2s,border-color .2s,box-shadow .2s;animation:fadeUp .5s ease both}
.project-card:hover{transform:translateY(-4px);border-color:rgba(108,99,255,.4);box-shadow:0 12px 40px rgba(0,0,0,.4),0 0 0 1px rgba(108,99,255,.2)}
.card-thumb-placeholder{width:100%;height:170px;background:linear-gradient(135deg,var(--surface2),#1a1e2e);display:flex;align-items:center;justify-content:center;font-size:3rem;position:relative;overflow:hidden}
.card-thumb-placeholder img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
.card-type-badge{position:absolute;top:.6rem;right:.6rem;font-size:.65rem;letter-spacing:.1em;text-transform:uppercase;padding:.25em .7em;border-radius:99px;font-weight:500}
.type-pdf{background:rgba(255,107,107,.2);color:#ff6b6b;border:1px solid rgba(255,107,107,.3)}
.type-video{background:rgba(108,99,255,.2);color:#a78bfa;border:1px solid rgba(108,99,255,.3)}
.type-image{background:rgba(107,203,119,.2);color:#6bcb77;border:1px solid rgba(107,203,119,.3)}
.type-doc{background:rgba(255,217,61,.2);color:#ffd93d;border:1px solid rgba(255,217,61,.3)}
.type-game{background:rgba(255,165,0,.2);color:#ffb347;border:1px solid rgba(255,165,0,.3)}
.type-audio{background:rgba(255,107,200,.2);color:#ff6bc8;border:1px solid rgba(255,107,200,.3)}
.type-other{background:rgba(139,144,164,.2);color:var(--text2);border:1px solid var(--border)}
.card-body{padding:1.1rem}
.card-author{font-size:.72rem;color:var(--text3);text-transform:uppercase;letter-spacing:.1em;margin-bottom:.4rem}
.card-title{font-family:'Syne',sans-serif;font-weight:600;font-size:1rem;line-height:1.3;margin-bottom:.5rem}
.card-desc{font-size:.82rem;color:var(--text2);line-height:1.55;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.card-footer{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1.1rem;border-top:1px solid var(--border);font-size:.75rem;color:var(--text3)}
.card-open{background:none;border:1px solid var(--border2);color:var(--text2);padding:.3rem .8rem;border-radius:6px;font-size:.75rem;cursor:pointer;font-family:'Outfit',sans-serif;transition:all .15s}
.card-open:hover{background:var(--accent);border-color:var(--accent);color:#fff}

/* VIEWER */
#page-viewer{background:var(--bg)}
.viewer-topbar{position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:1rem;padding:.8rem 1.5rem;background:rgba(11,13,20,.9);backdrop-filter:blur(18px);border-bottom:1px solid var(--border)}
.back-btn{background:var(--surface2);border:1px solid var(--border);color:var(--text2);padding:.45rem .9rem;border-radius:8px;font-size:.82rem;cursor:pointer;font-family:'Outfit',sans-serif;display:flex;align-items:center;gap:.4rem;transition:color .15s}
.back-btn:hover{color:var(--text)}
.viewer-title-bar{font-family:'Syne',sans-serif;font-weight:600;font-size:1rem}
.viewer-body{max-width:900px;margin:0 auto;padding:2rem 1.5rem 5rem}
.viewer-meta{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center;margin-bottom:1.5rem}
.viewer-chip{background:var(--surface2);border:1px solid var(--border);padding:.3em .8em;border-radius:99px;font-size:.78rem;color:var(--text2)}
.viewer-content{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;min-height:400px}
.viewer-iframe{width:100%;height:70vh;border:none;background:#fff}
.viewer-video{width:100%;max-height:70vh;background:#000;display:block}
.viewer-image{width:100%;max-height:80vh;object-fit:contain;display:block;margin:auto}
.viewer-audio-wrap{padding:3rem;display:flex;flex-direction:column;align-items:center;gap:1rem}
.viewer-audio{width:100%;max-width:400px}
.viewer-external{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;gap:1rem;text-align:center}
.viewer-external .ext-icon{font-size:4rem}
.viewer-external p{color:var(--text2);font-size:.9rem}
.viewer-desc-box{margin-top:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem}
.viewer-desc-box h3{font-family:'Syne',sans-serif;font-size:.85rem;color:var(--text3);margin-bottom:.8rem;text-transform:uppercase;letter-spacing:.1em}
.viewer-desc-box p{color:var(--text);line-height:1.7;font-size:.95rem}

/* UPLOAD */
#page-upload{padding-top:80px}
.upload-container{max-width:680px;margin:0 auto;padding:3rem 1.5rem 5rem}
.upload-header{text-align:center;margin-bottom:2.5rem}
.upload-header h2{font-family:'Syne',sans-serif;font-size:2.2rem;font-weight:700}
.upload-header p{color:var(--text2);margin-top:.6rem}
.form-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.8rem;margin-bottom:1.2rem}
.form-card h3{font-family:'Syne',sans-serif;font-size:.82rem;color:var(--text3);text-transform:uppercase;letter-spacing:.15em;margin-bottom:1.4rem;padding-bottom:.8rem;border-bottom:1px solid var(--border)}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
.field{margin-bottom:1.1rem}.field:last-child{margin-bottom:0}
label{display:block;font-size:.8rem;font-weight:500;color:var(--text2);margin-bottom:.4rem}
label .req{color:var(--accent2)}
input[type="text"],input[type="password"],textarea,select{width:100%;padding:.7rem .9rem;background:var(--bg);border:1px solid var(--border2);border-radius:8px;color:var(--text);font-family:'Outfit',sans-serif;font-size:.9rem;outline:none;transition:border-color .2s,box-shadow .2s}
input:focus,textarea:focus,select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(108,99,255,.15)}
textarea{resize:vertical;min-height:80px}
select option{background:var(--surface)}
.dropzone{border:2px dashed var(--border2);border-radius:10px;padding:2.5rem 1.5rem;text-align:center;cursor:pointer;transition:border-color .2s,background .2s;position:relative}
.dropzone:hover,.dropzone.dragover{border-color:var(--accent);background:rgba(108,99,255,.05)}
.dropzone input[type="file"]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
.dz-icon{font-size:2.5rem;margin-bottom:.7rem;display:block}
.dz-title{font-family:'Syne',sans-serif;font-weight:600;margin-bottom:.3rem}
.dz-hint{font-size:.78rem;color:var(--text3)}
#file-list{margin-top:1rem;display:flex;flex-direction:column;gap:.5rem}
.file-item{display:flex;align-items:center;gap:.8rem;padding:.6rem .9rem;background:var(--surface2);border:1px solid var(--border);border-radius:8px;font-size:.83rem;animation:fadeUp .2s ease}
.fi-icon{font-size:1.2rem;flex-shrink:0}.fi-name{flex:1;word-break:break-all}.fi-size{color:var(--text3);font-size:.72rem;flex-shrink:0}
.fi-rm{background:none;border:none;cursor:pointer;color:var(--text3);font-size:1rem;padding:2px 5px;border-radius:4px;transition:color .15s}.fi-rm:hover{color:var(--accent2)}
.pw-wrap{position:relative}.pw-wrap input{padding-right:2.8rem}
.pw-eye{position:absolute;right:.8rem;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--text3);font-size:1rem}
#upload-progress{display:none;margin-top:1rem}
.prog-bar-bg{background:var(--surface2);border-radius:99px;height:6px;overflow:hidden;margin-bottom:.4rem}
.prog-bar-fill{height:100%;background:linear-gradient(90deg,var(--accent),#a78bfa);border-radius:99px;width:0%;transition:width .3s}
.prog-label{font-size:.75rem;color:var(--text3);text-align:right}
.btn-upload{width:100%;padding:.9rem;background:var(--accent);color:#fff;border:none;border-radius:10px;font-family:'Outfit',sans-serif;font-size:.95rem;font-weight:500;cursor:pointer;transition:background .15s,transform .1s;display:flex;align-items:center;justify-content:center;gap:.6rem;margin-top:1.4rem;box-shadow:0 4px 24px var(--glow)}
.btn-upload:hover{background:#5a52e8}.btn-upload:active{transform:scale(.99)}.btn-upload:disabled{background:#3a3a5a;cursor:not-allowed;box-shadow:none}
.spinner{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite;display:none}
.btn-upload.loading .spinner{display:block}
.config-chip{display:inline-flex;align-items:center;gap:.5rem;background:rgba(255,107,107,.08);border:1px dashed rgba(255,107,107,.3);color:#ff8888;padding:.5rem 1rem;border-radius:8px;font-size:.78rem;margin-bottom:1.5rem;line-height:1.5}

/* ABOUT */
#page-about{padding-top:80px}
.about-container{max-width:760px;margin:0 auto;padding:3rem 1.5rem 5rem}
.about-container h1{font-family:'Syne',sans-serif;font-size:2.5rem;font-weight:800;margin-bottom:.5rem}
.grad{background:linear-gradient(135deg,var(--accent),#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.about-container .lead{color:var(--text2);font-size:1.05rem;line-height:1.7;margin-bottom:2rem}
.about-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-bottom:1rem}
.about-card h3{font-family:'Syne',sans-serif;font-weight:600;margin-bottom:.6rem}
.about-card p{color:var(--text2);font-size:.9rem;line-height:1.7}

/* TOAST */
#toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(8px);background:var(--surface2);color:var(--text);border:1px solid var(--border2);padding:.75rem 1.5rem;border-radius:10px;font-size:.85rem;opacity:0;transition:opacity .3s,transform .3s;z-index:999;white-space:nowrap;max-width:90vw;text-align:center;box-shadow:0 8px 32px rgba(0,0,0,.4)}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
#toast.success{background:#1a2e1e;border-color:rgba(107,203,119,.4);color:#6bcb77}
#toast.error{background:#2e1a1a;border-color:rgba(255,107,107,.4);color:#ff6b6b}

/* EMPTY STATE */
.empty-state{grid-column:1/-1;text-align:center;padding:5rem 2rem;color:var(--text3)}
.empty-state .empty-icon{font-size:3rem;margin-bottom:1rem}

@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes spin{to{transform:rotate(360deg)}}
@media(max-width:600px){nav{padding:.8rem 1rem}.nav-links .nav-btn:not(.upload-btn){display:none}.hero{padding:7rem 1rem 3rem}.stats-bar{flex-wrap:wrap}.stat-item{min-width:50%;border-right:none;border-bottom:1px solid var(--border)}.form-row{grid-template-columns:1fr}}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="nav-logo" onclick="showPage('home')">‚ú¶ Vidiverse</div>
  <div class="nav-links">
    <button class="nav-btn active-tab" id="nav-home" onclick="showPage('home')">Startseite</button>
    <button class="nav-btn" id="nav-about" onclick="showPage('about')">√úber uns</button>
    <button class="nav-btn" id="nav-impressum" onclick="showPage('impressum')">Impressum</button>
    <button class="nav-btn upload-btn" id="nav-upload" onclick="showPage('upload')">+ Projekt hochladen</button>
  </div>
</nav>

<!-- HOME -->
<div class="page active" id="page-home">
  <div class="hero">
    <div class="hero-glow"></div>
    <div class="hero-badge">‚ú¶ Dreht√ºrprojekt ¬∑ KGSE Elmshorn</div>
    <h1><span class="grad">Vidiverse</span></h1>
    <p class="hero-sub">Die Projektplattform der Begabtenf√∂rderung der Erich-K√§stner-Gemeinschaftsschule Elmshorn. Entdecke Projekte, Ausarbeitungen und Ideen unserer Sch√ºlerinnen und Sch√ºler.</p>
    <div class="hero-actions">
      <button class="btn-primary" onclick="document.getElementById('projects-section').scrollIntoView({behavior:'smooth'})">Projekte entdecken ‚Üì</button>
      <button class="btn-secondary" onclick="showPage('about')">Was ist das Dreht√ºrprojekt?</button>
    </div>
  </div>

  <div class="stats-bar">
    <div class="stat-item"><div class="stat-num" id="stat-projects">‚Äî</div><div class="stat-lbl">Projekte</div></div>
    <div class="stat-item"><div class="stat-num" id="stat-students">‚Äî</div><div class="stat-lbl">Sch√ºler</div></div>
    <div class="stat-item"><div class="stat-num">5+</div><div class="stat-lbl">Kategorien</div></div>
    <div class="stat-item"><div class="stat-num">KGSE</div><div class="stat-lbl">Elmshorn</div></div>
  </div>

  <section id="projects-section">
    <div class="section-header">
      <h2>Alle <span>Projekte</span></h2>
    </div>
    <div class="filter-tabs">
      <button class="filter-tab active" onclick="filterProjects('all',this)">Alle</button>
      <button class="filter-tab" onclick="filterProjects('pdf',this)">üìÑ Dokumente</button>
      <button class="filter-tab" onclick="filterProjects('video',this)">üé¨ Videos</button>
      <button class="filter-tab" onclick="filterProjects('image',this)">üñº Bilder</button>
      <button class="filter-tab" onclick="filterProjects('game',this)">üéÆ Spiele</button>
      <button class="filter-tab" onclick="filterProjects('audio',this)">üéµ Audio</button>
    </div>
    <div class="project-grid" id="project-grid"></div>
  </section>
</div>

<!-- VIEWER -->
<div class="page" id="page-viewer">
  <div class="viewer-topbar">
    <button class="back-btn" onclick="showPage('home')">‚Üê Zur√ºck</button>
    <span class="viewer-title-bar" id="viewer-title"></span>
  </div>
  <div class="viewer-body">
    <div class="viewer-meta" id="viewer-meta"></div>
    <div class="viewer-content" id="viewer-content"></div>
    <div class="viewer-desc-box" id="viewer-desc-box" style="display:none">
      <h3>Beschreibung</h3>
      <p id="viewer-desc-text"></p>
    </div>
  </div>
</div>

<!-- UPLOAD -->
<div class="page" id="page-upload">
  <div class="upload-container">
    <div class="upload-header">
      <h2>Projekt <span class="grad">hochladen</span></h2>
      <p>Lade deine Projektarbeit hoch ‚Äî sie erscheint dann auf der Startseite.</p>
    </div>

    <div class="config-chip">
      ‚öôÔ∏è Repository: VIDIVERSE/VIDIVERSE ¬∑ Token beim Upload eingeben (wird nicht gespeichert)
    </div>

    <div class="form-card">
      <h3>Projektdaten</h3>
      <div class="form-row">
        <div class="field"><label>Name <span class="req">*</span></label><input type="text" id="u-name" placeholder="Vorname Nachname"/></div>
        <div class="field"><label>Klasse</label><input type="text" id="u-class" placeholder="z.B. 7b"/></div>
      </div>
      <div class="field"><label>Projekttitel <span class="req">*</span></label><input type="text" id="u-title" placeholder="Titel deines Projekts"/></div>
      <div class="field">
        <label>Kategorie</label>
        <select id="u-type">
          <option value="other">Sonstiges</option>
          <option value="pdf">Dokument / PDF</option>
          <option value="video">Video</option>
          <option value="image">Bild / Poster</option>
          <option value="audio">Audio</option>
          <option value="game">Spiel / Interaktiv</option>
        </select>
      </div>
      <div class="field"><label>Beschreibung (optional)</label><textarea id="u-desc" placeholder="Worum geht es in deinem Projekt?"></textarea></div>
      <div class="field"><label>Externer Link (optional ‚Äî z.B. itch.io, YouTube‚Ä¶)</label><input type="text" id="u-link" placeholder="https://..."/></div>
    </div>

    <div class="form-card">
      <h3>Dateien</h3>
      <div class="dropzone" id="dropzone">
        <input type="file" id="file-input" multiple accept=".pdf,.docx,.doc,.pptx,.ppt,.mp3,.mp4,.mov,.wav,.png,.jpg,.jpeg,.gif,.zip,.txt"/>
        <span class="dz-icon">üìÇ</span>
        <div class="dz-title">Dateien ablegen oder klicken</div>
        <div class="dz-hint">PDF, DOCX, MP3, MP4, Bilder, ZIP ‚Ä¶</div>
      </div>
      <div id="file-list"></div>
    </div>

    <div class="form-card">
      <h3>Zugang</h3>
      <div class="field">
        <label>Passwort (GitHub Personal Access Token)</label>
        <div class="pw-wrap">
          <input type="password" id="u-pw" placeholder="github_pat_..."/>
          <button class="pw-eye" type="button" onclick="togglePw()">üëÅ</button>
        </div>
      </div>
      <div id="upload-progress">
        <div class="prog-bar-bg"><div class="prog-bar-fill" id="prog-fill"></div></div>
        <div class="prog-label" id="prog-label">0 %</div>
      </div>
      <button class="btn-upload" id="submit-btn" onclick="handleUpload()">
        <div class="spinner"></div>
        <span class="btn-text">Projekt hochladen ‚Üí</span>
      </button>
    </div>
  </div>
</div>

<!-- IMPRESSUM -->
<div class="page" id="page-impressum">
  <div class="about-container">
    <h1><span class="grad">Impressum</span></h1>
    <p class="lead">Die Projekt-Webseite f√ºr das Dreht√ºrprojekt der KGSE</p>

    <div class="about-card">
      <h3>üè´ Diensteanbieter</h3>
      <p>Erich K√§stner Gemeinschaftsschule Elmshorn<br>
      Hainholzer Damm 15<br>
      25337 Elmshorn<br>
      Deutschland</p>
    </div>

    <div class="about-card">
      <h3>üì¨ Kontaktm√∂glichkeiten</h3>
      <p>
        <strong>E-Mail Schule:</strong> erich-kaestner-gemeinschaftsschule.elmshorn@schule.landsh.de<br>
        <strong>E-Mail Website-Inhaber:</strong> jonathan.magnus.reinhardt@kgse-elmshorn.org<br>
        <strong>Telefon:</strong> (04121) 47513-0<br>
        <strong>Fax:</strong> (04121) 47513-50
      </p>
    </div>

    <div class="about-card">
      <h3>‚öñÔ∏è Aufsichtsbeh√∂rde</h3>
      <p>Schultr√§ger (Diensteanbieter im Sinne des TDG / MDStV):<br>
      Stadt Elmshorn ‚Äì Der B√ºrgermeister<br>
      Haupt- und Rechtsamt<br>
      Schulstr. 15‚Äì17, 25335 Elmshorn<br>
      Tel. (04121) 231-0 ¬∑ Fax (04121) 22384<br><br>
      <a href="https://www.elmshorn.de/Rathaus-Politik/Stadtverwaltung/%C3%84mter-Stabsstellen/%C3%84mter/Haupt-und-Rechtsamt/"
         target="_blank" style="color:var(--accent)">www.elmshorn.de ‚Üí Haupt- und Rechtsamt ‚Üó</a></p>
    </div>

    <div class="about-card">
      <h3>ü§ñ Vorbehalt der Nutzung f√ºr Text und Data Mining</h3>
      <p>Der Inhaber dieser Website gestattet die Nutzung oder das Herunterladen von Inhalten dieser Website durch Dritte f√ºr die Entwicklung, das Training oder den Betrieb von k√ºnstlicher Intelligenz oder anderen maschinellen Lernsystemen (‚ÄûText und Data Mining") ausschlie√ülich mit ausdr√ºcklicher schriftlicher Zustimmung des Inhabers. Ohne eine solche Zustimmung ist es untersagt, die Inhalte f√ºr Text und Data Mining zu verwenden. Dies gilt auch, wenn auf der Website keine Meta-Angaben vorhanden sind, die entsprechende Verfahren aussperren, und selbst dann, wenn Bots, die den Zweck haben, die Website zu Zwecken des Text und Data Mining auszulesen, nicht ausgesperrt werden.</p>
    </div>

    <div class="about-card">
      <h3>üîó Haftung f√ºr externe Links</h3>
      <p>Unsere Website enth√§lt Links zu externen Websites Dritter, auf deren Inhalte wir keinen Einfluss haben. Deshalb k√∂nnen wir f√ºr diese fremden Inhalte auch keine Gew√§hr √ºbernehmen. F√ºr die Inhalte der verlinkten Seiten ist stets der jeweilige Anbieter oder Betreiber der Seiten verantwortlich. Zum Zeitpunkt der Verlinkung wurden die Seiten auf m√∂gliche Rechtsverst√∂√üe √ºberpr√ºft; rechtswidrige Inhalte waren zum Zeitpunkt der Verlinkung nicht erkennbar. Eine permanente inhaltliche Kontrolle der verlinkten Seiten ist jedoch ohne konkrete Anhaltspunkte einer Rechtsverletzung nicht zumutbar. Bei Bekanntwerden von Rechtsverletzungen werden wir derartige Links umgehend entfernen.</p>
    </div>
  </div>
</div>

<!-- ABOUT -->
<div class="page" id="page-about">
  <div class="about-container">
    <h1>√úber <span class="grad">Vidiverse</span></h1>
    <p class="lead">Vidiverse ist die digitale Projektplattform f√ºr das Dreht√ºrprojekt der Begabtenf√∂rderung an der Erich-K√§stner-Gemeinschaftsschule (KGSE) in Elmshorn.</p>
    <div class="about-card">
      <h3>üö™ Was ist das Dreht√ºrprojekt?</h3>
      <p>Im Dreht√ºrprojekt haben besonders begabte Sch√ºlerinnen und Sch√ºler die M√∂glichkeit, sich zeitweise aus dem regul√§ren Unterricht auszuklinken und eigenst√§ndig Projekte zu einem Thema ihrer Wahl zu erarbeiten. Die fertigen Arbeiten werden hier auf Vidiverse pr√§sentiert.</p>
    </div>
    <div class="about-card">
      <h3>üìÅ Was findet man hier?</h3>
      <p>Von wissenschaftlichen Ausarbeitungen √ºber selbst entwickelte Spiele bis hin zu Kunstprojekten und Videos ‚Äî alle Dreht√ºrprojekte der KGSE k√∂nnen hier eingesehen und heruntergeladen werden.</p>
    </div>
    <div class="about-card">
      <h3>üè´ Erich-K√§stner-Gemeinschaftsschule Elmshorn</h3>
      <p>Die KGSE ist eine Gemeinschaftsschule in Elmshorn, Schleswig-Holstein. Das Dreht√ºrprojekt ist Teil des Begabtenf√∂rderungsprogramms der Schule.</p>
    </div>
    <div class="about-card">
      <h3>üîí Upload & Datenschutz</h3>
      <p>Projekte k√∂nnen nur mit einem g√ºltigen GitHub-Token hochgeladen werden. Alle Dateien werden sicher im Schularchiv gespeichert. Bei Fragen wende dich an deine betreuende Lehrkraft.</p>
    </div>
  </div>
</div>

<div id="toast"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  ‚öôÔ∏è  KONFIGURATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const GITHUB_REPO   = "VIDIVERSE/VIDIVERSE";
const UPLOAD_FOLDER = "projekte";
const BRANCH        = "main";

let uploadToken = "";  // Token wird beim Upload eingegeben, nie gespeichert
let allProjects = [];
let currentFilter = 'all';

// ‚îÄ‚îÄ GITHUB PROJEKTE LADEN ‚îÄ‚îÄ
async function loadProjectsFromGitHub() {
  showLoadingState();
  try {
    // Alle Ordner im UPLOAD_FOLDER abrufen
    const apiUrl = `https://api.github.com/repos/${GITHUB_REPO}/contents/${UPLOAD_FOLDER}?ref=${BRANCH}`;
    const res = await fetch(apiUrl, {
      headers: { Accept: "application/vnd.github+json" }
    });

    if (!res.ok) {
      if (res.status === 404) {
        // Ordner existiert noch nicht ‚Üí leere Galerie
        allProjects = [];
        renderGrid(currentFilter);
        return;
      }
      throw new Error('GitHub API: ' + res.status);
    }

    const folders = await res.json();
    const projectFolders = folders.filter(f => f.type === 'dir');

    const projects = await Promise.all(projectFolders.map(async (folder, i) => {
      try {
        // README.md des Projekts lesen
        const readmeRes = await fetch(
          `https://api.github.com/repos/${GITHUB_REPO}/contents/${folder.path}/README.md?ref=${BRANCH}`,
          { headers: { Accept: "application/vnd.github+json" } }
        );

        // Alle Dateien im Ordner abrufen
        const filesRes = await fetch(
          `https://api.github.com/repos/${GITHUB_REPO}/contents/${folder.path}?ref=${BRANCH}`,
          { headers: { Accept: "application/vnd.github+json" } }
        );

        let meta = { title: folder.name, author: '‚Äì', class: '', type: 'other', desc: '', date: '', link: '' };

        if (readmeRes.ok) {
          const readmeJson = await readmeRes.json();
          const md = decodeURIComponent(escape(atob(readmeJson.content.replace(/\n/g, ''))));
          meta = parseReadme(md);
        }

        // Erste nicht-README Datei als Hauptdatei
        let mainFile = null;
        let thumbFile = null;
        if (filesRes.ok) {
          const files = await filesRes.json();
          const nonReadme = files.filter(f => f.type === 'file' && f.name.toLowerCase() !== 'readme.md');
          if (nonReadme.length > 0) {
            mainFile = nonReadme[0];
            // Thumbnail: erstes Bild falls vorhanden
            const imgFile = nonReadme.find(f => /\.(png|jpg|jpeg|gif|webp)$/i.test(f.name));
            if (imgFile) thumbFile = imgFile;
          }
        }

        // Datum aus Ordnername (Format: YYYY-MM-DD_...)
        const dateMatch = folder.name.match(/^(\d{4}-\d{2}-\d{2})/);
        const date = meta.date || (dateMatch ? dateMatch[1] : folder.name.substring(0,10));

        const rawBase = `https://raw.githubusercontent.com/${GITHUB_REPO}/${BRANCH}/${folder.path}`;

        return {
          id: i + 1,
          title: meta.title || folder.name,
          author: meta.author || '‚Äì',
          class: meta.class || '',
          type: meta.type || guessType(mainFile ? mainFile.name : ''),
          desc: meta.desc || '',
          date,
          url: meta.link
            ? meta.link
            : (mainFile ? `${rawBase}/${mainFile.name}` : ''),
          thumb: thumbFile && meta.type !== 'image'
            ? `${rawBase}/${thumbFile.name}`
            : null,
          external: !!meta.link && !mainFile,
          folderPath: folder.path,
          rawBase,
        };
      } catch (e) {
        console.warn('Fehler bei Ordner', folder.name, e);
        return null;
      }
    }));

    allProjects = projects.filter(Boolean).reverse(); // Neueste zuerst
    renderGrid(currentFilter);

  } catch (err) {
    console.error('Fehler beim Laden der Projekte:', err);
    showErrorState(err.message);
  }
}

function parseReadme(md) {
  const get = (key) => {
    const re = new RegExp(`\\*\\*${key}[^\\*]*\\*\\*[:\\s]+(.+)`, 'i');
    const m = md.match(re);
    return m ? m[1].trim() : '';
  };
  const titleMatch = md.match(/^#\s+(.+)/m);
  const descMatch = md.match(/## Beschreibung\s+([\s\S]+?)(?:\n##|$)/i);
  return {
    title:  titleMatch ? titleMatch[1].trim() : '',
    author: get('Sch√ºler(?:\\/in)?'),
    class:  get('Klasse'),
    type:   get('Typ'),
    desc:   descMatch ? descMatch[1].trim() : '',
    date:   get('Datum'),
    link:   get('Link'),
  };
}

function guessType(filename) {
  const ext = filename.split('.').pop().toLowerCase();
  if (['pdf','doc','docx','ppt','pptx'].includes(ext)) return 'pdf';
  if (['mp4','mov','avi','webm'].includes(ext)) return 'video';
  if (['mp3','wav','ogg','flac'].includes(ext)) return 'audio';
  if (['png','jpg','jpeg','gif','webp'].includes(ext)) return 'image';
  return 'other';
}

function showLoadingState() {
  const grid = document.getElementById('project-grid');
  grid.innerHTML = `
    <div class="empty-state" style="grid-column:1/-1">
      <div style="font-size:2.5rem;margin-bottom:1rem;animation:spin 1.2s linear infinite;display:inline-block">‚ü≥</div>
      <p style="color:var(--text2)">Projekte werden geladen‚Ä¶</p>
    </div>`;
}

function showErrorState(msg) {
  const grid = document.getElementById('project-grid');
  grid.innerHTML = `
    <div class="empty-state" style="grid-column:1/-1">
      <div class="empty-icon">‚ö†Ô∏è</div>
      <p style="color:var(--accent2);margin-bottom:.5rem">Projekte konnten nicht geladen werden.</p>
      <p style="font-size:.8rem;color:var(--text3)">${msg}</p>
      <p style="font-size:.8rem;color:var(--text3);margin-top:.5rem">GitHub API nicht erreichbar. Bitte Internetverbindung pr√ºfen.</p>
    </div>`;
}

const TYPE = {
  pdf:  {label:'PDF',cls:'type-pdf',emoji:'üìÑ'},
  video:{label:'Video',cls:'type-video',emoji:'üé¨'},
  image:{label:'Bild',cls:'type-image',emoji:'üñº'},
  doc:  {label:'Dok.',cls:'type-doc',emoji:'üìù'},
  game: {label:'Spiel',cls:'type-game',emoji:'üéÆ'},
  audio:{label:'Audio',cls:'type-audio',emoji:'üéµ'},
  other:{label:'Sonstiges',cls:'type-other',emoji:'üìé'},
};
function tc(t){return TYPE[t]||TYPE.other}

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function showPage(name){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById('page-'+name).classList.add('active');
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active-tab'));
  const nb=document.getElementById('nav-'+name);
  if(nb)nb.classList.add('active-tab');
  window.scrollTo(0,0);
  if(name==='home')renderGrid(currentFilter);
}

// ‚îÄ‚îÄ GRID ‚îÄ‚îÄ
function renderGrid(filter){
  const grid=document.getElementById('project-grid');
  const list=filter==='all'?allProjects:allProjects.filter(p=>p.type===filter);
  if(!list.length){
    grid.innerHTML=`<div class="empty-state"><div class="empty-icon">üîç</div><p>Keine Projekte in dieser Kategorie.</p></div>`;
    return;
  }
  grid.innerHTML=list.map((p,i)=>{
    const t=tc(p.type);
    const thumb=p.thumb
      ? `<img src="${p.thumb}" alt="${p.title}" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover"/>`
      : `<span style="font-size:3rem;position:relative;z-index:1">${t.emoji}</span>`;
    return `<div class="project-card" style="animation-delay:${(i%8)*.05}s" onclick="openProject(${p.id})">
      <div class="card-thumb-placeholder">${thumb}<span class="card-type-badge ${t.cls}">${t.label}</span></div>
      <div class="card-body">
        <div class="card-author">von ${p.author}${p.class?' ¬∑ '+p.class:''}</div>
        <div class="card-title">${p.title}</div>
        <div class="card-desc">${p.desc||''}</div>
      </div>
      <div class="card-footer">
        <span>üìÖ ${p.date}</span>
        <button class="card-open">√ñffnen ‚Üí</button>
      </div>
    </div>`;
  }).join('');
  document.getElementById('stat-projects').textContent=allProjects.length;
  document.getElementById('stat-students').textContent=[...new Set(allProjects.map(p=>p.author))].length;
}

function filterProjects(f,btn){
  currentFilter=f;
  document.querySelectorAll('.filter-tab').forEach(t=>t.classList.remove('active'));
  btn.classList.add('active');
  renderGrid(f);
}

// ‚îÄ‚îÄ VIEWER ‚îÄ‚îÄ
function openProject(id){
  const p=allProjects.find(x=>x.id===id); if(!p)return;
  const t=tc(p.type);
  document.getElementById('viewer-title').textContent=p.title;
  document.getElementById('viewer-meta').innerHTML=`
    <span class="viewer-chip">‚úçÔ∏è ${p.author}</span>
    <span class="viewer-chip ${t.cls}">${t.label}</span>
    <span class="viewer-chip">üìÖ ${p.date}</span>
    ${p.class?`<span class="viewer-chip">üè´ Klasse ${p.class}</span>`:''}`;

  const content=document.getElementById('viewer-content');
  if(p.external){
    content.innerHTML=`<div class="viewer-external">
      <div class="ext-icon">${t.emoji}</div>
      <h3 style="font-family:'Syne',sans-serif;margin:.5rem 0">${p.title}</h3>
      <p>Dieses Projekt ist auf einer externen Seite verf√ºgbar.</p>
      <a href="${p.url}" target="_blank" style="text-decoration:none;margin-top:1rem">
        <button class="btn-primary">Extern √∂ffnen ‚Üó</button></a></div>`;
  } else if(p.type==='pdf'){
    content.innerHTML=`<iframe class="viewer-iframe" src="${p.url}" title="${p.title}"></iframe>`;
  } else if(p.type==='video'){
    content.innerHTML=`<video class="viewer-video" controls><source src="${p.url}">
      <div style="padding:2rem;color:var(--text2)">Video kann nicht abgespielt werden. 
      <a href="${p.url}" target="_blank" style="color:var(--accent)">Direkt √∂ffnen</a></div></video>`;
  } else if(p.type==='image'){
    content.innerHTML=`<img class="viewer-image" src="${p.url}" alt="${p.title}"/>`;
  } else if(p.type==='audio'){
    content.innerHTML=`<div class="viewer-audio-wrap"><div style="font-size:4rem">üéµ</div>
      <h3 style="font-family:'Syne',sans-serif">${p.title}</h3>
      <audio class="viewer-audio" controls><source src="${p.url}"></audio></div>`;
  } else {
    content.innerHTML=`<div class="viewer-external">
      <div class="ext-icon">${t.emoji}</div>
      <h3 style="font-family:'Syne',sans-serif;margin:.5rem 0">${p.title}</h3>
      <p>Datei kann nicht direkt angezeigt werden.</p>
      <a href="${p.url}" download target="_blank" style="text-decoration:none;margin-top:1rem">
        <button class="btn-primary">Herunterladen ‚Üì</button></a></div>`;
  }

  const db=document.getElementById('viewer-desc-box');
  if(p.desc){document.getElementById('viewer-desc-text').textContent=p.desc;db.style.display='block'}
  else db.style.display='none';
  showPage('viewer');
}

// ‚îÄ‚îÄ UPLOAD ‚îÄ‚îÄ
let selectedFiles=[];
function fIcon(n){const e=n.split('.').pop().toLowerCase();const m={pdf:'üìÑ',doc:'üìù',docx:'üìù',ppt:'üìä',pptx:'üìä',mp3:'üéµ',wav:'üéµ',mp4:'üé¨',mov:'üé¨',png:'üñº',jpg:'üñº',jpeg:'üñº',gif:'üñº',zip:'üóú',txt:'üìã'};return m[e]||'üìé'}
function fmtSize(b){if(b<1024)return b+' B';if(b<1048576)return (b/1024).toFixed(1)+' KB';return (b/1048576).toFixed(1)+' MB'}
function renderFiles(){
  document.getElementById('file-list').innerHTML=selectedFiles.map((f,i)=>
    `<div class="file-item"><span class="fi-icon">${fIcon(f.name)}</span><span class="fi-name">${f.name}</span><span class="fi-size">${fmtSize(f.size)}</span><button class="fi-rm" onclick="rmFile(${i})">‚úï</button></div>`).join('');
}
function rmFile(i){selectedFiles.splice(i,1);renderFiles()}

const dz=document.getElementById('dropzone'),fi=document.getElementById('file-input');
dz.addEventListener('dragover',e=>{e.preventDefault();dz.classList.add('dragover')});
dz.addEventListener('dragleave',()=>dz.classList.remove('dragover'));
dz.addEventListener('drop',e=>{e.preventDefault();dz.classList.remove('dragover');addFiles(e.dataTransfer.files)});
fi.addEventListener('change',()=>{addFiles(fi.files);fi.value=''});
function addFiles(l){for(const f of l)selectedFiles.push(f);renderFiles()}
function togglePw(){const p=document.getElementById('u-pw');p.type=p.type==='password'?'text':'password'}

function toast(msg,type=''){const t=document.getElementById('toast');t.textContent=msg;t.className='show '+type;setTimeout(()=>t.className='',3500)}
function setProgress(pct,lbl){document.getElementById('upload-progress').style.display='block';document.getElementById('prog-fill').style.width=pct+'%';document.getElementById('prog-label').textContent=lbl}
function slug(s){return s.trim().toLowerCase().replace(/[√§√Ñ]/g,'ae').replace(/[√∂√ñ]/g,'oe').replace(/[√º√ú]/g,'ue').replace(/√ü/g,'ss').replace(/[^a-z0-9]+/g,'-').replace(/^-|-$/g,'')}
function toB64(f){return new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result.split(',')[1]);r.onerror=rej;r.readAsDataURL(f)})}

async function ghUp(path,content,msg){
  const url=`https://api.github.com/repos/${GITHUB_REPO}/contents/${path}`;
  let sha;
  try{const c=await fetch(url,{headers:{Authorization:`token ${uploadToken}`,Accept:'application/vnd.github+json'}});if(c.ok){const j=await c.json();sha=j.sha}}catch(e){}
  const body={message:msg,content,branch:BRANCH};if(sha)body.sha=sha;
  const res=await fetch(url,{method:'PUT',headers:{Authorization:`token ${uploadToken}`,Accept:'application/vnd.github+json','Content-Type':'application/json'},body:JSON.stringify(body)});
  if(!res.ok){const err=await res.json();throw new Error(err.message||'GitHub Fehler')}
  return res.json();
}

async function handleUpload(){
  const name=document.getElementById('u-name').value.trim();
  const cls=document.getElementById('u-class').value.trim();
  const title=document.getElementById('u-title').value.trim();
  const type=document.getElementById('u-type').value;
  const desc=document.getElementById('u-desc').value.trim();
  const link=document.getElementById('u-link').value.trim();
  const token=document.getElementById('u-pw').value.trim();
  if(!name){toast('Bitte Namen eingeben.','error');return}
  if(!title){toast('Bitte Projekttitel eingeben.','error');return}
  if(!token){toast('Bitte Passwort eingeben.','error');return}
  if(!selectedFiles.length&&!link){toast('Bitte Datei oder Link angeben.','error');return}
  const btn=document.getElementById('submit-btn');
  btn.disabled=true;btn.classList.add('loading');
  const date=new Date().toISOString().split('T')[0];
  const folder=`${UPLOAD_FOLDER}/${date}_${slug(name)}_${slug(title)}`;
  try{
    const meta=`# ${title}\n\n**Sch√ºler/in:** ${name}${cls?'  |  **Klasse:** '+cls:''}\n**Datum:** ${date}\n**Typ:** ${type}${link?'\n**Link:** '+link:''}\n${desc?'\n## Beschreibung\n'+desc:''}`;
    await ghUp(`${folder}/README.md`,btoa(unescape(encodeURIComponent(meta))),`Dreht√ºr: ${title} ‚Äì ${name}`);
    for(let i=0;i<selectedFiles.length;i++){
      const f=selectedFiles[i];
      setProgress(Math.round((i/selectedFiles.length)*90),`Lade hoch: ${f.name}`);
      await ghUp(`${folder}/${f.name}`,await toB64(f),`Upload: ${f.name} ‚Äì ${title}`);
    }
    setProgress(100,'Fertig! ‚úì');
    toast('‚úÖ Erfolgreich hochgeladen!','success');
    const newP={id:Date.now(),title,author:name,class:cls,type,desc,date,
      url:link||(selectedFiles.length?`https://raw.githubusercontent.com/${GITHUB_REPO}/${BRANCH}/${folder}/${selectedFiles[0].name}`:''),
      thumb:null,external:!!link&&!selectedFiles.length};
    allProjects.unshift(newP);
    setTimeout(()=>{
      selectedFiles=[];renderFiles();
      ['u-name','u-class','u-title','u-desc','u-link','u-pw'].forEach(id=>document.getElementById(id).value='');
      document.getElementById('upload-progress').style.display='none';
      btn.disabled=false;btn.classList.remove('loading');
      showPage('home');
      loadProjectsFromGitHub(); // Projekte neu laden
      toast('üéâ Dein Projekt ist jetzt sichtbar!','success');
    },2000);
  }catch(err){
    toast('‚ùå Fehler: '+err.message,'error');
    btn.disabled=false;btn.classList.remove('loading');
  }
}

// INIT
loadProjectsFromGitHub();
</script>
</body>
</html>
